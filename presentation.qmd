---
title: "Momentum in Round-Based First-Person-Shooter (FPS) E-Sports"
author: "Tony ElHabr"
format:
  revealjs:
    incremental: false
    theme: [dark, theme.scss]
execute: 
  include: false
  echo: false
---

```{r}
#| label: setup
library(dplyr)
library(tibble)
library(qs)
library(scales)

rounds <- qs::qread(file.path('cod_rounds.qs'))
```

## What?

-   Call of Duty League (CDL)
    -   Search and Destroy (SnD)
-   Valorant Pro League
    -   Plant/Defuse

## How does a team win a round of SnD?

::: fragment
1.  One team eliminates all members of the other team prior to a bomb plant.
:::

::: fragment
2.  The offensive team eliminates all members of the defensive team after a bomb plant.
:::

::: fragment
3.  The defensive team defuses the bomb after a bomb plant.
:::

::: fragment
Often the defensive team will try to eliminate all offensive team members prior to making the defuse, but in some cases, they may try to "ninja" defuse.
:::

::: fragment
4.  The offensive team does not make a plant by the time the round timer ends.
:::

## Data set

```{r}
#| label: descriptive-cod-snd-stats
n_series <- rounds |> 
  distinct(year, sheet, series) |> 
  nrow() |> 
  scales::comma()

n_rounds <- rounds |> 
  distinct(year, sheet, series, round) |> 
  nrow() |> 
  scales::comma()

offensive_win_pct <- rounds |> 
  filter(is_offense) |> 
  count(win_round) |> 
  mutate(prop = n / sum(n)) |> 
  filter(win_round) |> 
  pull(prop) |> 
  scales::percent(accuracy = 1)

plant_pct <- rounds |>
  filter(is_offense) |> 
  count(makes_plant = !is.na(plant)) |> 
  mutate(prop = n / sum(n)) |> 
  filter(makes_plant) |> 
  pull(prop) |> 
  scales::percent(accuracy = 1)

offensive_plant_and_win_pct <- rounds |> 
  filter(is_offense, !is.na(plant)) |> 
  count(win_round) |> 
  mutate(prop = n / sum(n)) |> 
  filter(win_round) |> 
  pull(prop) |> 
  scales::percent(accuracy = 1)

offensive_first_blood_win_pct <- rounds |> 
  filter(!is.na(earned_fb)) |> 
  filter(earned_fb) |> 
  count(win_round) |> 
  mutate(prop = n / sum(n)) |> 
  filter(win_round) |> 
  pull(prop) |> 
  scales::percent(accuracy = 1)
```

::: fragment
-   Total series: **`r n_series`**
:::

::: fragment
-   Total rounds: **`r n_rounds`**
:::

::: fragment
-   Offensive sides plant %: **`r plant_pct`**
:::

::: fragment
-   Offensive win %: **`r offensive_win_pct`**
:::

::: fragment
-   Win % when planting: **`r offensive_plant_and_win_pct`**
:::

::: fragment
-   Win % when earning first blood: **`r offensive_first_blood_win_pct`**
:::

## What are your chances of winning a round, given the series state?

(This should hint at the 4-4 phenomenon.)

## How does reality compare to expectation?

(This should really highlight the 4-4 phenomenon.)

## What are your chances of going on to win the series, given the series state?

(More of the 4-4 phenomenon. Also should not win %s along the diagonal.)

## Are offensive win %'s different in round 1 (i.e. an "information-neutral" setting)?

![](offensive_win_r1_prop.png){fig-align="center"}

## Are offensive win %'s different in round 2?

![](offensive_win_r2_prop.png){fig-align="center"}

(Emperically, no)

## What are the most common series winning states?

## How do end states compare to expectation?

(There should be evidence of 6-0's and 6-5's being more frequent than expected given 50-50% chances. Might need to exclude major matchups, so that series are basically random.)

## Is there evidence for the "hot hand"?

![](hot_hand.png){fig-align="center"}

(Need to explain that this is sort of biased by the fact that teams end up winning series in 6 rounds more often than expected.)
